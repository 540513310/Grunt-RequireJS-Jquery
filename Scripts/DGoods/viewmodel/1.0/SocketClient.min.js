/*! bate version - v1.0 - vA packaged deploy by 冯达庆 . -2016-06-15 */;define(["socketio","../utils/SysConfig"],function(a,b){function c(a){this.setting=$.extend({onUserJoin:null,onUserLogout:null,onRequirePunished:null,onQuotedPunished:null,onQuotedConfirmed:null},a),this.user=null,this.connected=!1,this.socket=null,this.init()}return c.prototype={init:function(){this.socket=a(window.SysInfo.baseNodeJS),this.clientLogic()},userJoin:function(a){return this.user?(this.socket.emit("user_join",this.user),void(this.connected=!0)):!1},userLogout:function(a){return this.user?void this.socket.emit("user_logout",this.user):!1},sendQuoted:function(a){var b=this;return a&&b.connected?(b.socket.emit("new_quoted",a),!0):!1},sendConfirm:function(a){return a&&this.connected?(this.socket.emit("confirm_quoted",a),!0):!1},clientLogic:function(){var a=this;a.socket.on("user_joined",function(b){"function"==typeof a.setting.onUserJoin&&a.setting.onUserJoin.call(a,b)}),a.socket.on("user_loggedout",function(b){"function"==typeof a.setting.onUserLogout&&a.setting.onUserLogout.call(a,b)}),a.socket.on("require_punished",function(b){"function"==typeof a.setting.onRequirePunished&&a.setting.onRequirePunished(a,b)}),a.socket.on("quoted_punished",function(b){"function"==typeof a.setting.onQuotedPunished&&a.setting.onQuotedPunished(a,b)}),a.socket.on("quoted_confirmed",function(b){"function"==typeof a.setting.onQuotedConfirmed&&a.setting.onQuotedConfirmed(a,b)})}},c});