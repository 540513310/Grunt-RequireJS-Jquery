/*! bate version - v1.0 - vA packaged deploy by 冯达庆 . -2016-06-15 */;define(["jquery","jquerynicescroll","../utils/Common","../utils/SysUrl","../viewmodel/UserDealViewModel","../viewmodel/AccountViewModel"],function(a,b,c,d,e,f){var g=function(a){this.LoginUser=a,this.IsValidate=!0,this.Cert_Pass=!0,this.Cert_Done=!0,this.Cert_Doing=!0};return g.prototype.buildNavibar=function(b){var c=this,d=new e;d.setter(c.LoginUser.DDUserId),d.userDeal(function(c){var d=c.Data;1==c.isSuccess&&0==c.Data.STATE?(a(".TotalFinding").text(c.Data.OFFERING),a(".TotalDealt").text(c.Data.CONFIRMED),a(".TotalOverTime").text(c.Data.EXPIRED+c.Data.CANCELED),a(".TotalVied").text(c.Data.BIDDED),a(".TotalViening").text(c.Data.BIDDING),a(".TotalViedSuccess").text(c.Data.VICTORY),a(".TotalViedFail").text(c.Data.LOSE)):(d=a.extend({},c.Data),d.BIDDED=0,d.BIDDING=0,d.CANCELED=0,d.CONFIRMED=0,d.EXPIRED=0,d.LOSE=0,d.OFFERING=0,d.VICTORY=0),"function"==typeof b&&b.call(this,d)})},g.prototype.isIdentify=function(){var a=this;"undefined"==typeof a.LoginUser.DDUserId?a.IsValidate=!1:""==a.LoginUser.UserName&&""!=a.LoginUser.FirmId&&(a.IsValidate=!1);var b;if(a.IsValidate||(b={title:"您当前未绑定联系手机，请绑定后再操作!",desc:"进行找货报价需要设置联系手机，以便买卖双方可以相互联系，顺利开展洽谈工作。",button:{cleanBtn:{visable:!0,text:"取消",OnCancel:function(){}},enterBtn:{text:"添加绑定手机",url:"",onConfrim:function(){window.open(d.getUrl("Users/Setting/BindMobile"),"_self")}}}}),!a.IsValidate){var e=new c.CustDialog(b);return void e.showNoCertDialog()}var g=new f,h={Title:"",Desc:"",EnterBtn:"",Viscancel:!0};g.settercert(a.LoginUser.DDUserId),g.queryCert(function(b){if(0==b.Data.STATE){"X"==b.Data.CERTSTATE?(a.Cert_Pass=!1,h.Title="您的资料未通过审核，请重新认证！",h.Desc="未通过原因:"+b.Data.CERTDESC+",如有疑问请联系客服:0510-66001000",h.EnterBtn="重新认证"):"N"==b.Data.CERTSTATE?(a.Cert_Done=!1,h.Title="您当前未进行认证，请先认证后再操作！",h.Desc="找货报价需经过认证，您当前尚未进行此认证。",h.EnterBtn="去认证"):"C"==b.Data.CERTSTATE&&(a.Cert_Doing=!1,h.Title="您的资料正在审核中，请耐心等待！",h.Desc="您可以拨打客服电话0510-66001000，了解审核进度。",h.EnterBtn="确定",h.Viscancel=!1);var e={title:h.Title,desc:h.Desc,button:{cleanBtn:{visable:h.Viscancel,text:"取消",OnCancel:function(){}},enterBtn:{text:h.EnterBtn,url:"",onConfrim:function(){a.Cert_Pass&&a.Cert_Done||window.open(d.getUrl("Users/ValidateInfo/BaseInfo?type=D"),"_self")}}}};if(!a.Cert_Pass||!a.Cert_Done||!a.Cert_Doing){var f=new c.CustDialog(e);f.showNoCertDialog()}}})},g.prototype.buildScroll=function(){a(".vien-left").niceScroll({cursorcolor:"#d5eaff",cursoropacitymax:1,touchbehavior:!1,cursorwidth:"8px",cursorborder:"0",cursorborderradius:"5px"}),a(".vien-right").niceScroll({cursorcolor:"#d5eaff",cursoropacitymax:1,touchbehavior:!1,cursorwidth:"8px",cursorborder:"0",cursorborderradius:"5px"}),a(".quote-ul").niceScroll({cursorcolor:"#d5eaff",cursoropacitymax:1,touchbehavior:!1,cursorwidth:"8px",cursorborder:"0",cursorborderradius:"5px"})},g});