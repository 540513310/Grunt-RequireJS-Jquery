/*! bate version - v1.0 - vA packaged deploy by 冯达庆 . -2016-06-15 */;define(["jquery","jquerytmpl","NavibarCtl","../utils/SysUrl","../utils/Common","../utils/SysConfig","../viewmodel/RmdOrderViewModel"],function(a,b,c,d,e,f,g){var h=function(b,c){this.Currentlst=[],this.Current={},this.LoginUser=b,this.RequireIdLst=c,this.RmdModel=new g,this.RmdTemplate=a("#RmdTemplate"),this.FollowContent=a(".follow-content"),this.FollowNone=a(".follow-none"),this.RmdMarkup=a(".RmdMarkup"),this.TotalRmdOrder=a(".TotalRmdOrder"),this.TotalLst=[],this.init(),this.queryinfo()};return h.prototype={init:function(){var a=this,b=new c(a.LoginUser);b.buildNavibar(function(){})},queryinfo:function(){var b=this,c=0;b.TotalLst=[];for(var d=0;d<b.RequireIdLst.length;d++)b.RmdModel.setter(b.LoginUser.DDUserId,b.RequireIdLst[d]),b.RmdModel.getRecommandOrder(function(d){if(c+=1,d.isSuccess&&0==d.Data.STATE&&d.Data.DATAS.length>0){for(var e=0;e<d.Data.DATAS.length;e++)d.Data.DATAS[e].ROWTYPE="even",e%2==0&&(d.Data.DATAS[e].ROWTYPE="odd"),d.Data.DATAS[e].PCTYPENAME="Dh","A"==d.Data.DATAS[e].PRICETYPE&&(d.Data.DATAS[e].PCTYPENAME="Sc");b.TotalLst=b.TotalLst.concat(d.Data.DATAS)}if(c==b.RequireIdLst.length){var f=[],g=[];a.each(b.TotalLst,function(b,c){-1===a.inArray(c.PROID,g)&&(f.push(c),g.push(c.PROID))}),b.TotalLst=f,b.RmdTemplate.tmpl(b.TotalLst).appendTo(".rmd-tbody"),b.TotalRmdOrder.text(b.TotalLst.length),b.bindEvent()}})},bindEvent:function(){var b=this;b.TotalLst.length>0?a(b.FollowContent).css("display","block"):a(b.FollowNone).css("display","block"),a(".btn-Detail").unbind("click"),a(".btn-Detail").click(function(){var b=a(this).closest(".RmdMarkup");if("undefined"!=typeof b){var c=b.attr("data-id");window.open(d.getUrl("/product/detail/"+c))}})}},h});