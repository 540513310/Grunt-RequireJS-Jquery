/*! bate version - v1.0 - vA packaged deploy by 冯达庆 . -2016-06-15 */;define(["jquery","jqueryui","../utils/SysUrl"],function(a,b,c){a.fn.showext=function(b){function c(a){e.css("display","none"),"function"==typeof a&&a.call(this)}var d=a.extend({Caption:"",Title:"",Detail:"",Width:0,onClose:null,onCancel:null,onConfirm:null},b);this.find(".model-caption").text(d.Caption),this.find(".modal-title").text(d.Title),this.find(".modal-detail").text(d.Detail),0!=d.Width&&this.find(".modal-content").css("width",d.Width);var e=this,f=e.find(".close");f.click(function(){c(d.onClose)});var g=e.find(".cancel");g.click(function(){c(d.onCancel)});e.find(".cancel");g.click(function(){c(d.onCancel)});var h=e.find(".confirm");h.click(function(){c(d.onConfirm)}),window.onclick=function(a){a.target==e[0]&&c(d.onClose)},this.find(".modal-content").draggable(),e.css("display","block")},a.fn.showpopu=function(b){var d=function(){this.setting=a.extend({Title:"",templateHtml:"",ConfirmTitle:"确定",CloseTitle:"取消",TimeOut:6e4,onClose:null,onConfirm:null},b),this.init()};d.prototype={init:function(){var b=this,d=document.createElement("link");d.type="text/css",d.rel="stylesheet",d.href=c.getUrl("/Content/Users/DGoods/modalDailog.css"),document.getElementsByTagName("head")[0].appendChild(d);var e='<div  class=\'NotifyPopu modalPopu\'> <div class="modalPopu-content"><div class="popu-header"><span class="popu-title">'+b.setting.Title+'</span><span class="close">×</span><p class="model-caption"></p></div><div class="modal-body">'+b.setting.templateHtml+'</div><div class="footer"><div class="btncancel" type="button"><a class="popu-btn-cancel">'+b.setting.CloseTitle+'</a></div> <div class="btnconfirm" type="button"> <a class="menu_btn_sub popu-btn-sub">'+b.setting.ConfirmTitle+"</a></div></div></div></div>",f=a("#body");void 0==f[0]&&(f=a(".main")),f.append(e),a(".NotifyPopu").css("display","block"),b.setPosition(),b.exOperation(),b.closeWindow()},setPosition:function(){var b=a(".NotifyPopu").height(),c=a(".NotifyPopu").width();b=b>=200?200:b,c=c>=380?380:c,b=145>=b?145:b,c=300>=c?300:c,a(".NotifyPopu").draggable({start:function(){a(this).css({height:b,width:c})},stop:function(){a(this).css({height:b,width:c})}}),a(".NotifyPopu").height(b),a(".NotifyPopu").width(c),a(".NotifyPopu").css("position","fixed");var d,e;"undefined"!=typeof a(".NotifyPopu").last().position()&&a(".NotifyPopu").length>1&&(d=a(".NotifyPopu").last().position().top,e=a(".NotifyPopu").last().position().left,d-=35,a(".NotifyPopu").last().offset({top:d,left:e}))},exOperation:function(){var b=0;a(".NotifyPopu").unbind("click"),a(".NotifyPopu").click(function(){0==b&&(b=a(this).zIndex()+1);var c=a(this);a(".NotifyPopu").each(function(d,e){c[0]==a(e)[0]?a(e).zIndex(b):a(e).zIndex(b-1)})})},closeWindow:function(){function b(b){var c=a(b).closest('div[class^="NotifyPopu"]');c.remove()}var c=this;a(".btnconfirm").unbind("click"),a(".btnconfirm").click(function(){"function"==typeof c.setting.onConfirm&&c.setting.onConfirm.call(this),b(this)});var d=a(".close");d.unbind("click"),d.click(function(){"function"==typeof c.setting.onClose&&c.setting.onClose.call(this),b(this)});var e=a(".btncancel");e.unbind("click"),e.click(function(){"function"==typeof c.setting.onClose&&c.setting.onClose.call(this),b(this)});var f=!1,g=setTimeout(function(){b(a('div[class^="NotifyPopu"]')[0])},c.setting.TimeOut);a(".NotifyPopu").unbind("click"),a(".NotifyPopu").click(function(){try{f||clearTimeout(g)}catch(a){}finally{f=!0}})}},new d}});